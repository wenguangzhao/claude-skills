<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HTML即時プレビュー</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
      .fade-enter {
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
      }
      .fade-enter-active {
        opacity: 1;
      }
      textarea {
        font-family: "Menlo", "Monaco", "Courier New", monospace;
      }
    </style>
  </head>
  <body class="bg-gray-50 h-screen w-screen overflow-hidden flex flex-col">
    <div
      id="editor-container"
      class="flex-1 flex flex-col h-full transition-all duration-500 ease-in-out p-4 max-w-5xl mx-auto w-full"
    >
      <header class="mb-4 flex justify-between items-center">
        <div>
          <h1 class="text-2xl font-bold text-gray-800">HTML プレビュー</h1>
          <p class="text-sm text-gray-500">
            コードを貼り付けて、レンダリング結果を確認してください。
          </p>
        </div>
      </header>

      <main
        class="flex-1 relative border border-gray-300 rounded-xl shadow-sm overflow-hidden bg-white"
      >
        <textarea
          id="code-input"
          class="w-full h-full p-4 resize-none focus:outline-none text-sm leading-relaxed text-gray-800"
          placeholder="ここにHTMLコードを貼り付けてください...
例:
<div class='p-10 text-center'>
  <h1 class='text-3xl font-bold text-blue-600'>こんにちは！</h1>
</div>"
        ></textarea>
      </main>

      <footer class="mt-4 flex justify-end">
        <button
          onclick="runPreview()"
          class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow-lg transform transition hover:-translate-y-0.5 active:translate-y-0 cursor-pointer flex items-center gap-2"
        >
          <span>プレビュー実行</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-5 h-5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"
            />
          </svg>
        </button>
      </footer>
    </div>

    <div
      id="preview-container"
      class="fixed inset-0 z-50 bg-white hidden flex flex-col"
    >
      <iframe
        id="preview-frame"
        class="w-full h-full border-none flex-1"
      ></iframe>

      <div class="absolute bottom-6 right-6 group">
        <button
          onclick="closePreview()"
          class="bg-gray-800/80 hover:bg-gray-900 text-white p-3 rounded-full shadow-xl backdrop-blur-sm transition-all duration-300 flex items-center gap-2 pr-4 opacity-50 hover:opacity-100 group-hover:pr-6"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-5 h-5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M16.862 4.487l1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"
            />
          </svg>
          <span
            class="text-sm font-medium hidden group-hover:inline whitespace-nowrap"
            >コードを編集</span
          >
        </button>
      </div>
    </div>

    <script>
      const TAILWIND_SCRIPT =
        '<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"><\/script>';

      function runPreview() {
        const codeInput = document.getElementById("code-input").value;
        const editorContainer = document.getElementById("editor-container");
        const previewContainer = document.getElementById("preview-container");
        const iframe = document.getElementById("preview-frame");

        let finalHtml = "";

        if (codeInput.toLowerCase().includes("<html")) {
          if (codeInput.toLowerCase().includes("<head>")) {
            finalHtml = codeInput.replace("<head>", "<head>" + TAILWIND_SCRIPT);
          } else {
            finalHtml = TAILWIND_SCRIPT + codeInput;
          }
        } else {
          finalHtml = `
                    <!DOCTYPE html>
                    <html lang="ja">
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        ${TAILWIND_SCRIPT}
                    </head>
                    <body>
                        ${codeInput}
                    </body>
                    </html>
                `;
        }

        iframe.srcdoc = finalHtml;

        editorContainer.classList.add("hidden");
        previewContainer.classList.remove("hidden");
      }

      function closePreview() {
        const editorContainer = document.getElementById("editor-container");
        const previewContainer = document.getElementById("preview-container");
        const iframe = document.getElementById("preview-frame");

        previewContainer.classList.add("hidden");
        editorContainer.classList.remove("hidden");

        iframe.srcdoc = "";
      }

      document
        .getElementById("code-input")
        .addEventListener("keydown", function (e) {
          if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
            runPreview();
          }
        });
    </script>
  </body>
</html>
